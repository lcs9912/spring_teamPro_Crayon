<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.sample1.mapper.QnaMapper">

	<!-- 게시글 리스트 불러오기  -->
	<select id="selectQnaList" parameterType="hashmap"
		resultType="com.example.sample1.model.Qna">
			SELECT *
			FROM T1_QNA Q
			LEFT JOIN (
				SELECT COUNT(*)COM_CNT ,Q_NUMBER
				FROM T1_QNA_COMMENT
				GROUP BY Q_NUMBER
			) C ON Q.QNA_NUMBER = C.Q_NUMBER
			INNER JOIN T1_QNA_CATEGORIE G ON Q.QNA_TYPE = G.QNA_TYPE_NUMBER
			ORDER BY Q_NUMBER DESC
	</select>
	
	<!-- 게시글 등록하기 -->
	<insert id="insertQna" parameterType="hashmap">
		INSERT INTO T1_QNA VALUES
		(NULL,#{qnaType},#{title},#{name},#{contents},CURDATE(),CURDATE(),'N','0','N')
	</insert>
	
	<!-- 게시글 상세보기 -->
	<select id="selectQnaInfo" parameterType="hashmap" resultType="com.example.sample1.model.Qna">
		SELECT *
		FROM T1_QNA Q
		LEFT JOIN (
		SELECT COUNT(*) COM_CNT, Q_NUMBER
		FROM T1_QNA_COMMENT
		GROUP BY Q_NUMBER
		) C ON Q.QNA_NUMBER =C.Q_NUMBER
		WHERE QNA_NUMBER = #{qnaNumber}
	</select>
	
	<!-- 게시글 수정하기 -->
	<update id="updateQna" parameterType="hashmap" >
		UPDATE T1_QNA
		SET
			QNA_TITLE=#{qnaTitle},
			QNA_CONTENTS =#{qnaContents},
			QNA_TYPE =#{qnaType},
			QNA_UDATE = SYSDATE
		WHERE QNA_NUMBER = #{qnaNumber} 
	</update>
	
	
</mapper>